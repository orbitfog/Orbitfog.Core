Libraries for .NET.

Supported [target framework versions](https://docs.microsoft.com/en-us/dotnet/standard/frameworks):
* .NET 5 and above
* .NET Core 2.0 and above
* .NET Framework 4.5.1 and above
* .NET Standard 2.0 and above

# Orbitfog.Core.Database.DataReaderMapper

High-performance library base on `System.Linq.Expressions` to map `System.Data.Common.DbDataReader` to:
* public properties and fields in any class, e.g.: POCO or generated by ORM
* generic list with:
    * [built-in types](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/built-in-types)
    * enums
    * DateTime
    * DateTimeOffset
    * Guid

This library give you possibility change existing code, with low performance, for an existing database framework. Only requirement is access to `DbDataReader` object.

NuGet package - [Orbitfog.Core.Database.DataReaderMapper](https://www.nuget.org/packages/Orbitfog.Core.Database.DataReaderMapper)

## Configuration

Default behavior:
```cs
DbDataReaderMapperConfiguration.Default.CaseSensitive = true;
DbDataReaderMapperConfiguration.Default.UseProperties = true;
DbDataReaderMapperConfiguration.Default.UseFields = true;
```

Initialize the class before execute `ToList()`, but it is not necessary:
```cs
DbDataReaderMapper<SomeClass>.Initialize();
```

Changing behavior for the class:
```cs
DbDataReaderMapper<SomeClass>.Initialize(configuration =>
{
    configuration.CaseSensitive = false;
});
```
or
```cs
DbDataReaderMapper<SomeClass>.Initialize(new DbDataReaderMapperConfiguration()
{
    CaseSensitive = false
});
```

## Examples

Example 1:
```cs
DbCommand command = ...
...
List<SomeClass> list = DbDataReaderMapper<SomeClass>.ToList(command.ExecuteReader());
```

Example 2:
```cs
DbCommand command = ...
...
List<int?> list = DbDataReaderMapper<int?>.ToList(command.ExecuteReader());
```

Example 3:
```cs
DbCommand command = ...
...
List<string> list = DbDataReaderMapper<string>.ToList(command.ExecuteReader());
```

Example 4:
```cs
DbCommand command = ...
...
List<SomeEnum> list = DbDataReaderMapper<SomeEnum>.ToList(command.ExecuteReader());
```

## Performance test

* Microsoft SQL Server on local machine
* Create database `Orbitfog.Core.Database.DataReaderMapper.PerformanceTestCli` on local machine
* Generate sql file by running `Orbitfog.Core.Database.DataReaderMapper.PerformanceDataGeneratorCli` and execute file on local database, this create table `[dbo].[Test1]` with 100 000 rows.
* Build `Orbitfog.Core.Database.DataReaderMapper.PerformanceTestCli` as `Release` and run from `Visual Studio`: `Debug` > `Start Without Debugging`

### Results for `.NET 5` on Windows, in each the table cell the time is average for 5 executions in milliseconds:

| Name | 1 row | 10 rows | 100 rows | 1000 rows | 10000 rows | 100000 rows |
|:----|----:|----:|----:|----:|----:|----:|
| Hand coded #1 | 0,33 | 0,62 | 1,53 | 6,08  | 52,24 | 508,01 |
| Hand coded #2 | 0,32 | 0,56 | 1,51 | 5,02  | 55,48 | 502,96 |
| Hand coded #3 | 0,27 | 0,47 | 1,35 | 4,95  | 46,54 | 494,50 |
| Orbitfog.Core.Database.DataReaderMapper #1 | 0,30 | 0,47 | 1,20 | 5,15  | 48,13 | 514,50 |
| Orbitfog.Core.Database.DataReaderMapper #2 | 0,32 | 0,54 | 1,22 | 5,58  | 47,70 | 519,20 |
| Orbitfog.Core.Database.DataReaderMapper #3 | 0,26 | 0,55 | 1,31 | 5,19  | 48,07 | 514,71 |
| Dapper (Query&lt;T&gt;) #1 | 0,38 | 0,66 | 1,26 | 5,22  | 52,73 | 587,02 |
| Dapper (Query&lt;T&gt;) #2 | 0,31 | 0,56 | 1,41 | 5,30  | 51,83 | 585,99 |
| Dapper (Query&lt;T&gt;) #3 | 0,26 | 0,59 | 1,33 | 5,15  | 51,14 | 581,18 |
| EntityFrameworkCore #1 | 0,75 | 0,80 | 2,00 | 10,41  | 85,65 | 907,25 |
| EntityFrameworkCore #2 | 0,60 | 0,68 | 2,11 | 10,35  | 74,52 | 913,09 |
| EntityFrameworkCore #3 | 0,52 | 0,57 | 1,84 | 10,17  | 70,95 | 915,78 |

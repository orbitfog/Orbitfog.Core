Libraries for .NET.

Supported [target framework versions](https://docs.microsoft.com/en-us/dotnet/standard/frameworks):
* .NET Core 2.0 and above
* .NET Framework 4.5.1 and above
* .NET Standard 2.0 and above

# Orbitfog.Core.Database.Mapper

High-performance library base on `System.Linq.Expressions` to map `System.Data.Common.DbDataReader` to:
* public properties and fields in any class, e.g.: POCO or generated by ORM
* generic list with:
    * [built-in types](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/built-in-types)
    * enums
    * DateTime
    * DateTimeOffset
    * Guid

This library give you possibility change existing code, with low performance, for an existing database framework. Only requirement is access to `DbDataReader` object.

NuGet package - [Orbitfog.Core.Database.Mapper](https://www.nuget.org/packages/Orbitfog.Core.Database.Mapper)

## Configuration

Default behavior:
```cs
DbDataReaderMapperConfiguration.Default.CaseSensitive = true;
DbDataReaderMapperConfiguration.Default.UseProperties = true;
DbDataReaderMapperConfiguration.Default.UseFields = true;
```

Initialize the class before execute `ToList()`, but it is not necessary:
```cs
DbDataReaderMapper<SomeClass>.Initialize());
```

Changing behavior for the class:
```cs
DbDataReaderMapper<SomeClass>.Initialize(configuration =>
{
    configuration.CaseSensitive = false;
});
```
or
```cs
DbDataReaderMapper<SomeClass>.Initialize(new DbDataReaderMapperConfiguration()
{
    CaseSensitive = false
});
```

## Examples

Example 1:
```cs
DbCommand command = ...;
```
```cs
List<SomeClass> list = DbDataReaderMapper<SomeClass>.ToList(command.ExecuteReader());
```

Example 2:
```cs
DbCommand command = ...;
```
```cs
List<int?> list = DbDataReaderMapper<int?>.ToList(command.ExecuteReader());
```

Example 3:
```cs
DbCommand command = ...;
```
```cs
List<string> list = DbDataReaderMapper<string>.ToList(command.ExecuteReader());
```

Example 4:
```cs
DbCommand command = ...;
```
```cs
List<SomeEnum> list = DbDataReaderMapper<SomeEnum>.ToList(command.ExecuteReader());
```

## Performance test

* Microsoft SQL Server on local machine
* Create database `Orbitfog.Core.Database.Mapper.PerformanceTestCli` on local machine
* Generate sql file by running `Orbitfog.Core.Database.Mapper.PerformanceDataGeneratorCli` and execute file on local database, this create table `[dbo].[Test1]` with 100 000 rows.
* Build `Orbitfog.Core.Database.Mapper.PerformanceTestCli` as `Release` and run from `Visual Studio`: `Debug` > `Start Without Debugging`

### Results for `.NET Core 3.1` on Windows, in each the table cell the time is average for 5 executions:

| Name | 1 rows | 10 rows | 100 rows | 1000 rows | 10000 rows | 100000 rows |
|:----|----:|----:|----:|----:|----:|----:|
| Hand coded - first time | 0,28 ms | 0,50 ms | 1,44 ms | 7,29 ms  | 60,69 ms | 558,30 ms |
| Hand coded - second time | 0,32 ms | 0,51 ms | 1,34 ms | 5,27 ms  | 51,84 ms | 544,68 ms |
| Hand coded - third time | 0,24 ms | 0,46 ms | 1,33 ms | 5,07 ms  | 52,93 ms | 544,37 ms |
| Orbitfog.Core.Database.Mapper - first time | 0,31 ms | 0,72 ms | 1,50 ms | 5,52 ms  | 53,69 ms | 567,25 ms |
| Orbitfog.Core.Database.Mapper - second time | 0,27 ms | 0,59 ms | 1,25 ms | 5,40 ms  | 56,15 ms | 569,77 ms |
| Orbitfog.Core.Database.Mapper - third time | 0,24 ms | 0,62 ms | 1,22 ms | 5,84 ms  | 52,10 ms | 581,92 ms |
| Dapper (Query&lt;T&gt;) - first time | 0,31 ms | 0,50 ms | 1,31 ms | 5,49 ms  | 57,45 ms | 645,54 ms |
| Dapper (Query&lt;T&gt;) - second time | 0,30 ms | 0,48 ms | 1,26 ms | 5,36 ms  | 57,76 ms | 644,89 ms |
| Dapper (Query&lt;T&gt;) - third time | 0,24 ms | 0,50 ms | 1,28 ms | 5,44 ms  | 59,18 ms | 649,85 ms |
| EntityFrameworkCore - first time | 0,59 ms | 0,69 ms | 2,19 ms | 11,07 ms  | 121,46 ms | 1143,19 ms |
| EntityFrameworkCore - second time | 0,55 ms | 0,60 ms | 2,23 ms | 8,79 ms  | 106,23 ms | 1135,70 ms |
| EntityFrameworkCore - third time | 0,53 ms | 0,52 ms | 1,94 ms | 8,30 ms  | 105,59 ms | 1133,82 ms |
